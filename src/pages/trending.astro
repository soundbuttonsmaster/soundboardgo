---
import Layout from '@/layouts/Layout.astro';
import InfiniteScrollSoundGrid from '@/components/InfiniteScrollSoundGrid';
import SearchSection from '@/components/SearchSection';
import { soundService } from '@/services/sound.service';
import type { SoundButton as SoundButtonType } from '@/types';

let trendingSounds: SoundButtonType[] = [];
let hasMore = false;

try {
  const result = await soundService.getTrendingSounds(undefined, 1, 20);
  trendingSounds = result.sounds;
  hasMore = result.hasMore;
} catch (error) {
  console.error('Error fetching trending sounds:', error);
}
---

<Layout
  title="Trending Meme Soundboard: Popular Sound Buttons"
  description="Explore trending meme soundboard and sound buttons collection on Soundboard Go. Browse the most popular sound buttons, viral sound effects and soundboards right now!"
  keywords="trending sounds, popular sound effects, top soundboard clips, trending meme soundboard, popular sound buttons, viral sound effects"
  type="website"
  canonicalURL={Astro.site ? new URL('/trending', Astro.site).href : undefined}
>
  <section class="relative bg-gradient-to-br from-orange-500 via-slate-900 to-slate-950 text-white py-3 md:py-4 overflow-hidden">
    <div class="absolute inset-0 opacity-30" style="background-image: radial-gradient(circle at 1px 1px, rgba(255,255,255,0.25) 1px, transparent 0); background-size: 45px 45px;"></div>
    <div class="absolute inset-x-0 bottom-0 h-32 bg-gradient-to-t from-black/30 to-transparent"></div>
    <div class="relative max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 text-center space-y-4">
      <p class="text-sm uppercase tracking-[0.4em] text-orange-200">Community Favorites</p>
      <h1 class="text-2xl md:text-4xl font-bold drop-shadow">Trending Sound Buttons & Soundboard</h1>
      <p class="text-base md:text-lg text-slate-100 max-w-3xl mx-auto">
        Explore trending meme soundboard and sound buttons on Soundboard Go.
      </p>
      
      <!-- Search Field in Hero Section -->
      <div class="mt-6 max-w-2xl mx-auto">
        <SearchSection client:load variant="hero" />
      </div>
    </div>
  </section>

  <section class="pt-10 pb-10 bg-white">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">

      {trendingSounds.length > 0 ? (
      <InfiniteScrollSoundGrid
        client:load
        initialSounds={trendingSounds}
        type="trending"
        pageSize={20}
        initialHasMore={hasMore}
      />
      ) : (
        <div class="text-center py-12 bg-gray-50 rounded-2xl border border-dashed border-gray-200">
          <p class="text-gray-500">Trending data is updating. Please refresh in a moment.</p>
        </div>
      )}
    </div>
  </section>
</Layout>

