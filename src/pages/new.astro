---
import Layout from '@/layouts/Layout.astro';
import InfiniteScrollSoundGrid from '@/components/InfiniteScrollSoundGrid';
import SearchSection from '@/components/SearchSection';
import { soundService } from '@/services/sound.service';
import type { SoundButton as SoundButtonType } from '@/types';

let newSounds: SoundButtonType[] = [];
let hasMore = false;

try {
  const result = await soundService.getNewSounds(undefined, 1, 20);
  newSounds = result.sounds;
  hasMore = result.hasMore;
} catch (error) {
  console.error('Error fetching new sounds:', error);
}
---


<Layout
  title="New Meme Soundboard: Latest Sound Buttons"
  description="Explore the newest sound buttons and meme soundboards with fresh, trending sound effects updated daily to play, download, and share for gaming, memes, and fun!"
  keywords="new sounds, fresh audio clips, latest soundboard, newly added sound effects, new meme soundboard, latest sound buttons"
  type="website"
  canonicalURL={Astro.site ? new URL('/new', Astro.site).href : undefined}
>
  <section class="relative bg-gradient-to-br from-primary-700 via-slate-900 to-slate-900 text-white py-3 md:py-4 overflow-hidden">
    <div class="absolute inset-0 opacity-30" style="background-image: radial-gradient(circle at 1px 1px, rgba(255,255,255,0.35) 1px, transparent 0); background-size: 40px 40px;"></div>
    <div class="relative max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 text-center space-y-4">
      <p class="text-sm uppercase tracking-[0.4em] text-primary-200">Freshly Uploaded</p>
      <h1 class="text-2xl md:text-4xl font-bold drop-shadow">New Sound Buttons & Soundboard</h1>
      <p class="text-base md:text-lg text-slate-200 max-w-3xl mx-auto">
        Discover new sound buttons and meme soundboard on Soundboard Go!
      </p>
      
      <!-- Search Field in Hero Section -->
      <div class="mt-6 max-w-2xl mx-auto">
        <SearchSection client:load variant="hero" />
      </div>
    </div>
  </section>

  <section class="pt-16 pb-16 bg-white ">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 ">

      {newSounds.length > 0 ? (
      <InfiniteScrollSoundGrid
        client:load
        initialSounds={newSounds}
        type="new"
        pageSize={20}
        initialHasMore={hasMore}
      />
      ) : (
        <div class="text-center py-12 bg-gray-50 rounded-2xl border border-dashed border-gray-200">
          <p class="text-gray-500">New sounds are still processing. Please check back soon!</p>
        </div>
      )}
    </div>
  </section>
</Layout>

